/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java library project to get you started.
 * For more details take a look at the 'Building Java & JVM projects' chapter in the Gradle
 * User Manual available at https://docs.gradle.org/6.8/userguide/building_java_projects.html
 */

plugins {
	id 'java-library'
	id 'jacoco'
}

apply plugin: 'maven-publish'

group 'com.cog'
version  '1.2'

publishing {
	publications {
		maven(MavenPublication) {
			artifact("build/libs/lib-$version" + ".jar") {
				extension "jar"
			}
		}
	}
	repositories {
		maven {
			name "nexus"
			url "http://localhost:8081/repository/maven-releases/"
			credentials {
				username "admin"
				password "admin@123"
			}
			allowInsecureProtocol = true
		}
	}
}
repositories {
	// Use JCenter for resolving dependencies.
	jcenter()
}
dependencies {
	testImplementation 'org.junit.jupiter:junit-jupiter-api:5.7.2'
	testImplementation 'org.junit.jupiter:junit-jupiter-engine:5.7.2'
	testImplementation 'org.mockito:mockito-all:1.10.19'
	api 'org.apache.commons:commons-math3:3.6.1'
	implementation 'com.google.guava:guava:29.0-jre'
}
test {
	useJUnitPlatform()
	finalizedBy jacocoTestReport // report is always generated after tests run
}
jacoco{
	reportsDirectory = layout.buildDirectory.dir('testReport')
}
jacocoTestReport {
	dependsOn test // tests are required to run before generating the report
	reports {
		xml.required = false
		csv.required = false
		html.outputLocation = layout.buildDirectory.dir('jacocoHtml')
	}
}

jacocoTestCoverageVerification {
	violationRules {
		failOnViolation = true
		rule {
			limit {
				minimum = 0.9
			}
		}
	}
}

